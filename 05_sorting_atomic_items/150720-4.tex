\exercise

Consider the Snow Plow technique (\autoref{alg:snowplow}). Simulate the working
of Snow Plow over the sequence $S = [1, 3, 9, 6, 2, 10, 4, 8, 5, 7]$ by assuming
that $M = 2$. Generate only the first sorted run.

\solution

We start the algorithm with $\mathcal{U} = [1, 3]$ (the first 2 elements of the
sequence). Then
%
\begin{description}[labelindent=0.5cm]

  \item[Run 1.] We build $\mathcal{H}$ over $\mathcal{U}$, obtaining
  $\mathcal{H} = [1, 3]$.
  %
  \begin{enumerate}

    \item $min = 1,\ next = 9 \ge min \Longrightarrow \mathcal{H} = [3, 9],\
    \mathcal{U} = [\,]$

    \item $min = 3,\ next = 6 \ge min \Longrightarrow \mathcal{H} = [6, 9],\
    \mathcal{U} = [\,]$

    \item $min = 6,\ next = 2 < min \Longrightarrow \mathcal{H} = [9],\
    \mathcal{U} = [2]$

    \item $min = 9,\ next = 10 \ge min \Longrightarrow \mathcal{H} = [10],\
    \mathcal{U} = [2]$

    \item $min = 10,\ next = 4 < min \Longrightarrow \mathcal{H} = [\,],\
    \mathcal{U} = [2, 4]$

  \end{enumerate}

\end{description}
%
\begin{algorithm}[b]
\caption{Snow Plow algorithm}\label{alg:snowplow}
\begin{algorithmic}[1]
\Require $\mathcal{U}$ unsorted array of $M$ items
\State Build a min-heap $\mathcal{H}$ over $\mathcal{U}$'s items
\State $\mathcal{U} \gets \emptyset$
\While{$\mathcal{H} \neq \emptyset$}
  \State $min \gets \min(\mathcal{H})$
  \State Write $min$ in the output run
  \State $next \gets$ next item from input sequence
  \If{$next < min$}
    \State Write $next$ in $\mathcal{U}$
  \Else
    \State Insert $next$ in $\mathcal{H}$
  \EndIf
\EndWhile
\end{algorithmic}
\end{algorithm}
